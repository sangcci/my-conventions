# 비즈니스 로직 vs 도메인 로직

다음 2가지 코드를 살펴보자.

1. 
```java
// service code
public class Shop {
  public void sell(Account account, Product product) {
    if (account.canAfford(product.getPrice()) {
      account.withdraw(product.getPrice());
      System.out.println(product.getName() + "를 구매했습니다.");
    } else {
      System.out.println("잔액이 부족합니다.");
    }
  }
}
// domain
class Account {

  private long money;

  public boolean canAfford(long amount) {
    return money >= amount;
  }

  public void withdraw(long amount) {
    money -= amount;
  }
}
```
2.
```java
public class Shop {
  public void sell(Account account, Product product) {
    account.withdraw(product.getPrice());
  }
}

class Account {

  private long money;

  private boolean canAfford(long amount) {
    return money >= amount;
  }

  public void withdraw(long amount) {
    if (canAfford(amount)) {
      money -= amount;
      System.out.println(product.getName() + "를 구매했습니다.");
    } else {
      System.out.println("잔액이 부족합니다.");
    }
  }
}
```
`withdraw()` 로직 내부에 `canAfford()` 검증 로직을 넣어서, Account에 행동 책임을 전가했다.

둘 중 어느 코드가 더 좋을까?

이는 추구하는 방향에 따라 다를 것 같다고 생각했다.
- Service 코드는 하나의 명세처럼 읽혀야 하는가
- 행동으로만 보여줘야 하는가

개인적인 경험으로는, 2번처럼 구현할 때 Service 코드가 간단하게 되고 그로인해 가독성이 좋아지는 코드를 만들었다.
하지만 너무 캡슐화 한 나머지, Service 테스트 코드를 작성할 때 해당 메서드가 어떤 flow를 가지는지 파악하기 힘들어서 테스트 코드도 같이 작성하기 힘든 기억이 있다.

다음과 같은 간단한 경우는 domain 비즈니스 로직으로 판단했다.
- 값 검증
- 값 변경

다음과 같은 경우는 Service 코드로 분류했다.
- 예외 처리
- 다른 모듈 사용

결국 1번처럼 구현하는 방법이
- 객체에게 책임을 위임
하는 적절한 방법이지 않을까 생각한다.

---

[자바/스프링 개발자를 위한 실용주의 프로그래밍 - 김우근]()
